import{_ as w,d as k,m as I,r as T,o as l,c as n,F as h,a as t,i as _,h as u,t as i,k as y,bl as S,e as v,w as b,g as p,f as V,v as $}from"./index-dc695ea1.js";import{S as C,c as x}from"./cart-b792bc43.js";import"./_commonjsHelpers-042e6b4d.js";const{VITE_URL:f,VITE_PATH:g}={VITE_URL:"https://vue3-course-api.hexschool.io/",VITE_PATH:"cal-for-you",BASE_URL:"/cal-for-you/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},U={data(){return{cart:{},loadingItem:"",disabled:!0,coupon:""}},methods:{updateCart(e){const o={product_id:e.product.id,qty:e.qty};this.loadingItem=e.id,this.$http.put(`${f}v2/api/${g}/cart/${e.id}`,{data:o}).then(r=>{this.cart=r.data.data,this.getCart(),this.loadingItem=""}).catch(r=>{alert(r.response.data.message)})},deleteCart(e){this.loadingItem=e.id,this.$http.delete(`${f}v2/api/${g}/cart/${e.id}`).then(()=>{this.getCart(),this.loadingItem="",localStorage.setItem("coupon",JSON.stringify(!1))}).catch(o=>{alert(o.response.data.message)})},deleteCarts(){C.fire({title:"確定要刪除所有品項嗎？",text:"此操作無法復原",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"刪除所有品項！",cancelButtonText:"取消"}).then(e=>{e.isConfirmed&&(C.fire({title:"所有品項已刪除!",icon:"success",confirmButtonColor:"#0d6efd"}),this.$http.delete(`${f}v2/api/${g}/carts`).then(()=>{this.getCart(),localStorage.setItem("coupon",JSON.stringify(!1))}).catch(o=>{alert(o.response.data.message)}))}).catch(e=>{alert(e.response.data.message)})},showToast(e,o){this.$refs.showCouponUsedToast.showCouponUsedToast(e,o)},clear(){this.coupon=""},...k(x,["getCart","addToCart","useCoupon","showToast"])},computed:{...I(x,["carts","total","final_total","couponIsUsed"])},mounted(){this.getCart()}},j={class:"container"},B=V('<section class="pt-6 pb-5"><h2 class="text-center pb-md-5 fw-bold">購物車清單</h2><div class="d-none d-md-block"><div class="row"><div class="col-3 pe-0"><div class="timeline-item d-flex flex-column align-items-center justify-content-center"><div class="line bg-black w-100"></div><div class="circle bg-primary border border-primary rounded-circle"></div><div class="mt-3 fw-bold">購物車清單</div></div></div><div class="col-3 px-0"><div class="timeline-item d-flex flex-column align-items-center justify-content-center"><div class="line bg-black w-100"></div><div class="circle bg-white border border-primary rounded-circle"></div><div class="mt-3">填寫訂購資料</div></div></div><div class="col-3 px-0"><div class="timeline-item d-flex flex-column align-items-center justify-content-center"><div class="line bg-black w-100"></div><div class="circle bg-white border border-primary rounded-circle"></div><div class="mt-3">填寫付款資料</div></div></div><div class="col-3 ps-0"><div class="timeline-item d-flex flex-column align-items-center justify-content-center"><div class="line bg-black w-100"></div><div class="circle bg-white border border-primary rounded-circle"></div><div class="mt-3">完成訂單</div></div></div></div></div></section>',1),E={class:"py-3"},N={class:"table table-hover align-middle"},R=t("thead",null,[t("tr",{class:"table-primary"},[t("th",{class:"col-2"},"刪除"),t("th",{class:"col-6"},"品名"),t("th",{class:"col-3"},"數量"),t("th",{class:"col-2"},"單價")])],-1),q=["disabled","onClick"],L={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},D=t("i",{class:"bi bi-trash3 fs-6"},null,-1),A={class:"d-flex flex-column flex-md-row align-items-center justify-content-center"},O={class:"col-12 col-md-3 pb-2 pb-md-0 me-md-2"},M=["src"],P={class:"col-12 col-md-9 text-center text-md-start"},F={class:"input-group input-group-sm"},H={class:"input-group"},J=["onUpdate:modelValue","disabled","onChange"],z=["value"],G=t("td",{colspan:"3",class:"text-end"},"商品總金額",-1),K={key:0},Q=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),W={class:"text-success"},X={class:"bg-primary-exlight p-4"},Y={class:"d-flex flex-column flex-sm-row justify-content-end align-items-center pb-5"},Z=t("div",{class:"pb-3 pb-sm-0"}," 輸入優惠碼 ",-1),tt={class:"px-3 pb-3 pb-sm-0"},et={key:0,class:"d-flex justify-content-center justify-content-sm-end align-items-center pb-4 text-danger fw-bold"},st={class:"d-flex flex-column flex-sm-row justify-content-between align-items-center"},ot={key:1,class:"position-absolute top-50 start-50 translate-middle w-100 text-center"},lt={class:"fs-2"};function nt(e,o,r,at,c,d){const m=T("RouterLink");return l(),n("div",j,[e.carts.length?(l(),n(h,{key:0},[B,t("section",E,[t("table",N,[R,t("tbody",null,[e.carts?(l(!0),n(h,{key:0},_(e.carts,s=>(l(),n("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:s.id===c.loadingItem,onClick:a=>d.deleteCart(s)},[s.id===c.loadingItem?(l(),n("span",L)):u("",!0),D],8,q)]),t("td",A,[t("div",O,[t("img",{src:s.product.imageUrl,class:"object-cover w-100",height:"120",alt:"productImage"},null,8,M)]),t("div",P,i(s.product.title),1)]),t("td",null,[t("div",F,[t("div",H,[y(t("select",{class:"form-select","onUpdate:modelValue":a=>s.qty=a,disabled:s.id===c.loadingItem,onChange:a=>d.updateCart(s)},[(l(!0),n(h,null,_(s.qty<=10?10:s.qty,a=>(l(),n("option",{value:a,key:`${a}165146`},i(a),9,z))),128))],40,J),[[$,s.qty]])])])]),t("td",null,i(s.product.price),1)]))),128)):u("",!0)]),t("tfoot",null,[t("tr",null,[G,t("td",null,"$"+i(e.$filters.currency(e.total)),1)]),e.couponIsUsed?(l(),n("tr",K,[Q,t("td",W,"$"+i(e.$filters.currency(e.final_total)),1)])):u("",!0)])])]),t("section",X,[t("div",Y,[Z,t("div",tt,[y(t("input",{type:"text",class:"p-1",placeholder:"請輸入優惠碼","onUpdate:modelValue":o[0]||(o[0]=s=>c.coupon=s)},null,512),[[S,c.coupon]])]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:o[1]||(o[1]=s=>{e.useCoupon(this.coupon),d.clear()})}," 使用 ")]),e.couponIsUsed?(l(),n("div",et," 優惠碼已使用，享"+i(e.final_total*10/e.total)+"折優惠 ",1)):u("",!0),t("div",st,[t("div",null,[t("button",{type:"button",onClick:o[2]||(o[2]=(...s)=>d.deleteCarts&&d.deleteCarts(...s)),class:"btn btn-outline-danger mb-4 mb-sm-0"},"刪除所有品項")]),t("div",null,[v(m,{to:"/products",class:"btn btn-light me-4"},{default:b(()=>[p("繼續購物")]),_:1}),v(m,{to:e.carts.length?"/orderInformation":"",class:"btn btn-primary"},{default:b(()=>[p(" 結帳("+i(e.carts.length)+") ",1)]),_:1},8,["to"])])])])],64)):(l(),n("section",ot,[t("div",lt,[t("div",null,[p("購物車目前沒有商品，"),v(m,{to:"/products",class:"link-primary text-decoration-none"},{default:b(()=>[p("繼續購物")]),_:1})])])]))])}const rt=w(U,[["render",nt]]);export{rt as default};
