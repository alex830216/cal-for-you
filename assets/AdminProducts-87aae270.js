import{M as w}from"./modal-507f238c.js";import{P as E}from"./PaginationComponent-d076741b.js";import{_ as x,r as b,o as n,c as r,e as d,w as L,a as e,bu as h,bk as f,F as k,k as C,n as _,bg as D,g as m,t as g}from"./index-27658160.js";import"./_commonjsHelpers-042e6b4d.js";const T={props:["tempProduct","addOrUpdateProduct","createImages"],computed:{innerProduct(){return this.tempProduct}}},q={class:"modal-dialog modal-xl"},N={class:"modal-content border-0"},$={class:"modal-header bg-dark text-white"},A={id:"productModalLabel",class:"modal-title"},F={key:0},O={key:1},B=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),R={class:"modal-body"},S={class:"row"},H={class:"col-12 col-sm-4"},z={class:"mb-2"},j={class:"mb-3"},G=e("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),J=["src"],K=e("h4",null,"多圖設置",-1),Q={key:0},W=["onUpdate:modelValue"],X=["src"],Y={key:1},Z={class:"col-12 col-sm-8"},ee=e("div",{class:"mb-3 text-danger"},"* 為必填",-1),te={class:"mb-3"},se=e("label",{for:"title",class:"form-label"},[m("標題 "),e("span",{class:"text-danger"},"*")],-1),oe={class:"row"},de={class:"mb-3 col-12 col-md-6"},le=e("label",{for:"category",class:"form-label"},[m("分類 "),e("span",{class:"text-danger"},"*")],-1),ae={class:"mb-3 col-12 col-md-6"},ne=e("label",{for:"unit",class:"form-label"},[m("單位 "),e("span",{class:"text-danger"},"*")],-1),re={class:"row"},ie={class:"mb-3 col-12 col-md-6"},ce=e("label",{for:"origin_price",class:"form-label"},[m("原價 "),e("span",{class:"text-danger"},"*")],-1),ue={class:"mb-3 col-12 col-md-6"},me=e("label",{for:"price",class:"form-label"},[m("售價 "),e("span",{class:"text-danger"},"*")],-1),_e=e("hr",null,null,-1),pe={class:"mb-3"},be=e("label",{for:"description",class:"form-label"},"產品描述",-1),he={class:"mb-3"},ge=e("label",{for:"content",class:"form-label"},"說明內容",-1),Pe={class:"mb-3"},fe={class:"form-check"},ve=e("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),ye={class:"mb-3"},Me=e("label",{for:"calorie",class:"form-label"},[m("熱量 "),e("span",{class:"text-danger"},"*")],-1),Ve={class:"mb-3"},ke=e("label",{for:"protein",class:"form-label"},[m("蛋白質 "),e("span",{class:"text-danger"},"*")],-1),xe={class:"modal-footer"},Ue=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),we=["disabled"];function Ce(i,t,a,U,p,s){const c=b("VField"),u=b("ErrorMessage"),M=b("VForm");return n(),r("div",q,[d(M,{onSubmit:a.addOrUpdateProduct},{default:L(({errors:l,meta:V})=>[e("div",N,[e("div",$,[e("h5",A,[s.innerProduct.id?(n(),r("span",O,"編輯產品")):(n(),r("span",F,"新增產品"))]),B]),e("div",R,[e("div",S,[e("div",H,[e("div",z,[e("div",j,[G,h(e("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":t[0]||(t[0]=o=>s.innerProduct.imageUrl=o)},null,512),[[f,s.innerProduct.imageUrl]])]),e("img",{class:"img-fluid",src:s.innerProduct.imageUrl,alt:"productImage"},null,8,J)]),e("div",null,[K,Array.isArray(s.innerProduct.imagesUrl)?(n(),r("div",Q,[(n(!0),r(k,null,C(s.innerProduct.imagesUrl,(o,P)=>(n(),r(k,{key:P+1653256},[h(e("input",{type:"text",class:"form-control","onUpdate:modelValue":I=>s.innerProduct.imagesUrl[P]=I},null,8,W),[[f,s.innerProduct.imagesUrl[P]]]),e("img",{src:s.innerProduct.imagesUrl[P],alt:"productImages",class:"img-fluid mb-2"},null,8,X)],64))),128)),!s.innerProduct.imagesUrl.length||s.innerProduct.imagesUrl[s.innerProduct.imagesUrl.length-1]?(n(),r("button",{key:0,type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:t[1]||(t[1]=o=>s.innerProduct.imagesUrl.push(""))}," 新增圖片 ")):(n(),r("button",{key:1,type:"button",class:"btn btn-outline-danger btn-sm d-block w-100",onClick:t[2]||(t[2]=o=>s.innerProduct.imagesUrl.pop())}," 刪除圖片 "))])):(n(),r("div",Y,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:t[3]||(t[3]=(...o)=>a.createImages&&a.createImages(...o))}," 新增圖片 ")]))])]),e("div",Z,[ee,e("div",te,[se,d(c,{id:"title",name:"標題",type:"text",class:_(["form-control",{"is-invalid":l.標題}]),placeholder:"請輸入標題",rules:"required",modelValue:s.innerProduct.title,"onUpdate:modelValue":t[4]||(t[4]=o=>s.innerProduct.title=o)},null,8,["class","modelValue"]),d(u,{name:"標題",class:"invalid-feedback"})]),e("div",oe,[e("div",de,[le,d(c,{id:"category",name:"分類",type:"text",class:_(["form-control",{"is-invalid":l.分類}]),placeholder:"請輸入分類",rules:"required",modelValue:s.innerProduct.category,"onUpdate:modelValue":t[5]||(t[5]=o=>s.innerProduct.category=o)},null,8,["class","modelValue"]),d(u,{name:"分類",class:"invalid-feedback"})]),e("div",ae,[ne,d(c,{id:"unit",name:"單位",type:"text",class:_(["form-control",{"is-invalid":l.單位}]),placeholder:"請輸入單位",rules:"required",modelValue:s.innerProduct.unit,"onUpdate:modelValue":t[6]||(t[6]=o=>s.innerProduct.unit=o)},null,8,["class","modelValue"]),d(u,{name:"單位",class:"invalid-feedback"})])]),e("div",re,[e("div",ie,[ce,d(c,{id:"origin_price",name:"原價",type:"number",class:_(["form-control",{"is-invalid":l.原價}]),placeholder:"請輸入原價",rules:"required|min_value:0",modelValue:s.innerProduct.origin_price,"onUpdate:modelValue":t[7]||(t[7]=o=>s.innerProduct.origin_price=o),modelModifiers:{number:!0}},null,8,["class","modelValue"]),d(u,{name:"原價",class:"invalid-feedback"})]),e("div",ue,[me,d(c,{id:"price",name:"售價",type:"number",class:_(["form-control",{"is-invalid":l.售價}]),placeholder:"請輸入售價",rules:"required|min_value:0",modelValue:s.innerProduct.price,"onUpdate:modelValue":t[8]||(t[8]=o=>s.innerProduct.price=o),modelModifiers:{number:!0}},null,8,["class","modelValue"]),d(u,{name:"售價",class:"invalid-feedback"})])]),_e,e("div",pe,[be,h(e("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":t[9]||(t[9]=o=>s.innerProduct.description=o)},`\r
                  `,512),[[f,s.innerProduct.description]])]),e("div",he,[ge,h(e("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":t[10]||(t[10]=o=>s.innerProduct.content=o)},`\r
                `,512),[[f,s.innerProduct.content]])]),e("div",Pe,[e("div",fe,[h(e("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[11]||(t[11]=o=>s.innerProduct.is_enabled=o)},null,512),[[D,s.innerProduct.is_enabled]]),ve])]),e("div",ye,[Me,d(c,{id:"calorie",name:"熱量",type:"number",class:_(["form-control",{"is-invalid":l.熱量}]),placeholder:"請輸入熱量",rules:"required|min_value:0",modelValue:s.innerProduct.calorie,"onUpdate:modelValue":t[12]||(t[12]=o=>s.innerProduct.calorie=o),modelModifiers:{number:!0}},null,8,["class","modelValue"]),d(u,{name:"熱量",class:"invalid-feedback"})]),e("div",Ve,[ke,d(c,{id:"protein",name:"蛋白質",type:"number",class:_(["form-control",{"is-invalid":l.蛋白質}]),placeholder:"請輸入蛋白質",rules:"required|min_value:0",modelValue:s.innerProduct.protein,"onUpdate:modelValue":t[13]||(t[13]=o=>s.innerProduct.protein=o),modelModifiers:{number:!0}},null,8,["class","modelValue"]),d(u,{name:"蛋白質",class:"invalid-feedback"})])])])]),e("div",xe,[Ue,e("button",{type:"submit",class:"btn btn-primary",disabled:!V.valid}," 確認 ",8,we)])])]),_:1},8,["onSubmit"])])}const Ie=x(T,[["render",Ce]]),Ee={props:["tempProduct","delProduct"]},Le={class:"modal-dialog"},De={class:"modal-content border-0"},Te=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delProductModalLabel",class:"modal-title"},[e("span",null,"刪除產品")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),qe={class:"modal-body"},Ne={class:"text-danger"},$e={class:"modal-footer"},Ae=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Fe(i,t,a,U,p,s){return n(),r("div",Le,[e("div",De,[Te,e("div",qe,[m(" 是否刪除 "),e("strong",Ne,g(a.tempProduct.title),1),m(" 商品(刪除後將無法恢復)。 ")]),e("div",$e,[Ae,e("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...c)=>a.delProduct&&a.delProduct(...c))}," 確認刪除 ")])])])}const Oe=x(Ee,[["render",Fe]]),{VITE_URL:v,VITE_PATH:y}={VITE_URL:"https://vue3-course-api.hexschool.io/",VITE_PATH:"cal-for-you",BASE_URL:"/cal-for-you/",MODE:"production",DEV:!1,PROD:!0},Be={props:["checkLogin"],data(){return{products:[],tempProduct:{imagesUrl:[]},isNew:!1,page:{},productModal:{},delProductModal:{}}},methods:{getProducts(i=1){this.$http.get(`${v}v2/api/${y}/admin/products?page=${i}`).then(t=>{this.products=t.data.products,this.page=t.data.pagination}).catch(t=>{alert(t.response.data.message)})},addOrUpdateProduct(){let i=`${v}v2/api/${y}/admin/product`,t="post";this.isNew||(i=`${v}v2/api/${y}/admin/product/${this.tempProduct.id}`,t="put"),this.tempProduct.id?this.$http[t](i,{data:this.tempProduct}).then(a=>{alert(a.data.message),this.getProducts(),this.productModal.hide()}).catch(a=>{alert(a.response.data.message)}):this.$http[t](i,{data:this.tempProduct}).then(a=>{alert(a.data.message),this.getProducts(),this.productModal.hide()}).catch(a=>{alert(a.response.data.message)})},delProduct(){const i=`${v}v2/api/${y}/admin/product/${this.tempProduct.id}`;this.$http.delete(i,{data:this.tempProduct}).then(t=>{alert(t.data.message),this.getProducts(),this.delProductModal.hide()}).catch(t=>{alert(t.response.data.message)})},createImages(){this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push("")},openModal(i,t){i==="create"?(this.productModal.show(),this.isNew=!0,this.tempProduct={imagesUrl:[]}):i==="edit"?(this.productModal.show(),this.isNew=!1,this.tempProduct={...t}):i==="delete"&&(this.delProductModal.show(),this.tempProduct={...t})}},components:{PaginationComponent:E,ProductModal:Ie,DelProductModal:Oe},mounted(){this.checkLogin(),this.getProducts(),this.productModal=new w(this.$refs.productModal),this.delProductModal=new w(this.$refs.delProductModal)}},Re={class:"container"},Se={class:"text-end mt-4"},He={class:"table mt-4"},ze=e("thead",null,[e("tr",null,[e("th",{width:"120"}," 分類 "),e("th",null,"產品名稱"),e("th",{width:"120"}," 原價 "),e("th",{width:"120"}," 售價 "),e("th",{width:"100"}," 是否啟用 "),e("th",{width:"120"}," 編輯 ")])],-1),je={class:"text-end"},Ge={class:"text-end"},Je={key:0,class:"text-success"},Ke={key:1},Qe={class:"btn-group"},We=["onClick"],Xe=["onClick"],Ye={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},Ze={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"};function et(i,t,a,U,p,s){const c=b("PaginationComponent"),u=b("ProductModal"),M=b("DelProductModal");return n(),r("div",Re,[e("div",Se,[e("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=l=>s.openModal("create"))}," 建立新的產品 ")]),e("table",He,[ze,e("tbody",null,[(n(!0),r(k,null,C(p.products,l=>(n(),r("tr",{key:l.id},[e("td",null,g(l.category),1),e("td",null,g(l.title),1),e("td",je,g(l.origin_price),1),e("td",Ge,g(l.price),1),e("td",null,[l.is_enabled?(n(),r("span",Je,"啟用")):(n(),r("span",Ke,"未啟用"))]),e("td",null,[e("div",Qe,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:V=>s.openModal("edit",l)}," 編輯 ",8,We),e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:V=>s.openModal("delete",l)}," 刪除 ",8,Xe)])])]))),128))])]),d(c,{pages:p.page,onChangePage:s.getProducts},null,8,["pages","onChangePage"]),e("div",Ye,[d(u,{"temp-product":p.tempProduct,"add-or-update-product":s.addOrUpdateProduct,"create-images":s.createImages},null,8,["temp-product","add-or-update-product","create-images"])],512),e("div",Ze,[d(M,{"temp-product":p.tempProduct,"del-product":s.delProduct},null,8,["temp-product","del-product"])],512)])}const lt=x(Be,[["render",et]]);export{lt as default};
