import{M as g}from"./modal-e0e5e6bb.js";import{P as k}from"./PaginationComponent-d8082917.js";import{_ as C,o as l,c as i,a as o,k as c,bl as r,bi as x,g as v,t as u,r as _,F as w,i as U,e as b}from"./index-dc695ea1.js";import"./_commonjsHelpers-042e6b4d.js";const V={props:["tempCoupon","addOrUpdateCoupon"],computed:{innerCoupon(){return this.tempCoupon}}},L={class:"modal-dialog modal-xl"},D={class:"modal-content border-0"},P={class:"modal-header bg-dark text-white"},E={id:"couponModalLabel",class:"modal-title"},T={key:0},N={key:1},O=o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),R={class:"modal-body"},A={class:"row"},B={class:"col-12"},I={class:"mb-3"},S=o("label",{for:"title",class:"form-label"},"標題",-1),F={class:"mb-3"},H=o("label",{for:"percent",class:"form-label"},"打折比例",-1),j={class:"mb-3"},q=o("label",{for:"due_date",class:"form-label"},"到期日",-1),z={class:"mb-3"},G=o("label",{for:"code",class:"form-label"},"優惠代碼",-1),J={class:"mb-3"},K={class:"form-check"},Q=o("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),W={class:"modal-footer"},X=o("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Y(n,t,s,f,p,e){return l(),i("div",L,[o("div",D,[o("div",P,[o("h5",E,[e.innerCoupon.id?(l(),i("span",N,"編輯產品")):(l(),i("span",T,"新增優惠券"))]),O]),o("div",R,[o("div",A,[o("div",B,[o("div",I,[S,c(o("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":t[0]||(t[0]=a=>e.innerCoupon.title=a)},null,512),[[r,e.innerCoupon.title]])]),o("div",F,[H,c(o("input",{id:"percent",type:"number",min:"0",max:"100",class:"form-control",placeholder:"請輸入打折比例","onUpdate:modelValue":t[1]||(t[1]=a=>e.innerCoupon.percent=a)},null,512),[[r,e.innerCoupon.percent]])]),o("div",j,[q,c(o("input",{id:"due_date",type:"month",class:"form-control",placeholder:"請輸入到期日","onUpdate:modelValue":t[2]||(t[2]=a=>e.innerCoupon.due_date=a)},null,512),[[r,e.innerCoupon.due_date]])]),o("div",z,[G,c(o("input",{id:"code",type:"text",class:"form-control",placeholder:"請輸入優惠代碼","onUpdate:modelValue":t[3]||(t[3]=a=>e.innerCoupon.code=a)},null,512),[[r,e.innerCoupon.code]])]),o("div",J,[o("div",K,[c(o("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=a=>e.innerCoupon.is_enabled=a)},null,512),[[x,e.innerCoupon.is_enabled]]),Q])])])])]),o("div",W,[X,o("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=(...a)=>s.addOrUpdateCoupon&&s.addOrUpdateCoupon(...a))}," 確認 ")])])])}const Z=C(V,[["render",Y]]),oo={props:["tempCoupon","delCoupon"]},to={class:"modal-dialog"},eo={class:"modal-content border-0"},no=o("div",{class:"modal-header bg-danger text-white"},[o("h5",{id:"delCouponModalLabel",class:"modal-title"},[o("span",null,"刪除產品")]),o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),so={class:"modal-body"},ao={class:"text-danger"},lo={class:"modal-footer"},io=o("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function po(n,t,s,f,p,e){return l(),i("div",to,[o("div",eo,[no,o("div",so,[v(" 是否刪除 "),o("strong",ao,u(s.tempCoupon.title),1),v(" 商品(刪除後將無法恢復)。 ")]),o("div",lo,[io,o("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...a)=>s.delCoupon&&s.delCoupon(...a))}," 確認刪除 ")])])])}const co=C(oo,[["render",po]]),{VITE_URL:h,VITE_PATH:m}={VITE_URL:"https://vue3-course-api.hexschool.io/",VITE_PATH:"cal-for-you",BASE_URL:"/cal-for-you/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},uo={props:["checkLogin"],data(){return{coupons:[],tempCoupon:{},isNew:!1,page:{},couponModal:{},delCouponModal:{}}},methods:{getCoupons(n=1){this.$http.get(`${h}v2/api/${m}/admin/coupons?page=${n}`).then(t=>{this.coupons=t.data.coupons,this.page=t.data.pagination}).catch(t=>{alert(t.response.data.message)})},addOrUpdateCoupon(){let n=`${h}v2/api/${m}/admin/coupon`,t="post";this.tempCoupon.due_date=Date.parse(this.tempCoupon.due_date),this.isNew||(n=`${h}v2/api/${m}/admin/coupon/${this.tempCoupon.id}`,t="put"),this.tempCoupon.id?this.$http[t](n,{data:this.tempCoupon}).then(s=>{alert(s.data.message),this.getCoupons(),this.couponModal.hide()}).catch(s=>{alert(s.response.data.message)}):this.$http[t](n,{data:this.tempCoupon}).then(s=>{alert(s.data.message),this.getCoupons(),this.couponModal.hide()}).catch(s=>{alert(s.response.data.message)})},delCoupon(){const n=`${h}v2/api/${m}/admin/coupon/${this.tempCoupon.id}`;this.$http.delete(n,{data:this.tempCoupon}).then(t=>{alert(t.data.message),this.getCoupons(),this.delCouponModal.hide()}).catch(t=>{alert(t.response.data.message)})},openModal(n,t){n==="create"?(this.couponModal.show(),this.isNew=!0,this.tempCoupon={}):n==="edit"?(this.couponModal.show(),this.isNew=!1,this.tempCoupon={...t},this.tempCoupon.due_date=this.$filters.dateMonth(this.tempCoupon.due_date)):n==="delete"&&(this.delCouponModal.show(),this.tempCoupon={...t})}},components:{PaginationComponent:k,CouponModal:Z,DelCouponModal:co},mounted(){this.checkLogin(),this.getCoupons(),this.couponModal=new g(this.$refs.couponModal),this.delCouponModal=new g(this.$refs.delCouponModal)}},ro={class:"container"},ho={class:"text-end mt-4"},mo={class:"table mt-4"},_o=o("thead",null,[o("tr",null,[o("th",{width:"120"}," 優惠券名稱 "),o("th",{width:"120"},"打折比例"),o("th",{width:"120"}," 到期日 "),o("th",{width:"120"}," 優惠代碼 "),o("th",{width:"100"}," 是否啟用 "),o("th",{width:"120"}," 編輯 ")])],-1),bo={key:0,class:"text-success"},Co={key:1},fo={class:"btn-group"},go=["onClick"],vo=["onClick"],Mo={id:"couponModal",ref:"couponModal",class:"modal fade",tabindex:"-1","aria-labelledby":"couponModalLabel","aria-hidden":"true"},yo={id:"delCouponModal",ref:"delCouponModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delCouponModalLabel","aria-hidden":"true"};function $o(n,t,s,f,p,e){const a=_("PaginationComponent"),M=_("CouponModal"),y=_("DelCouponModal");return l(),i("div",ro,[o("div",ho,[o("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=d=>e.openModal("create"))}," 建立新的優惠券 ")]),o("table",mo,[_o,o("tbody",null,[(l(!0),i(w,null,U(p.coupons,d=>(l(),i("tr",{key:d.id},[o("td",null,u(d.title),1),o("td",null,u(d.percent),1),o("td",null,u(n.$filters.dateMonth(d.due_date)),1),o("td",null,u(d.code),1),o("td",null,[d.is_enabled?(l(),i("span",bo,"啟用")):(l(),i("span",Co,"未啟用"))]),o("td",null,[o("div",fo,[o("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:$=>e.openModal("edit",d)}," 編輯 ",8,go),o("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:$=>e.openModal("delete",d)}," 刪除 ",8,vo)])])]))),128))])]),b(a,{pages:p.page,onChangePage:e.getCoupons},null,8,["pages","onChangePage"]),o("div",Mo,[b(M,{"temp-coupon":p.tempCoupon,"add-or-update-coupon":e.addOrUpdateCoupon},null,8,["temp-coupon","add-or-update-coupon"])],512),o("div",yo,[b(y,{"temp-coupon":p.tempCoupon,"del-coupon":e.delCoupon},null,8,["temp-coupon","del-coupon"])],512)])}const Vo=C(uo,[["render",$o]]);export{Vo as default};
