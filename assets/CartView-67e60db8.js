import{_ as k,d as w,m as x,r as I,o as l,c as n,F as h,a as t,j as g,W as r,t as d,bt as y,bk as V,e as m,w as v,f as u,i as $,bj as T}from"./index-37a6019e.js";import{c as C}from"./cart-e8736bef.js";const{VITE_URL:b,VITE_PATH:f}={VITE_URL:"https://vue3-course-api.hexschool.io/",VITE_PATH:"cal-for-you",BASE_URL:"/cal-for-you/",MODE:"production",DEV:!1,PROD:!0},U={data(){return{cart:{},loadingItem:"",disabled:!0,coupon:""}},methods:{updateCart(e){const o={product_id:e.product.id,qty:e.qty};this.loadingItem=e.id,this.$http.put(`${b}v2/api/${f}/cart/${e.id}`,{data:o}).then(_=>{this.cart=_.data.data,this.getCart(),this.loadingItem=""})},deleteCart(e){this.loadingItem=e.id,this.$http.delete(`${b}v2/api/${f}/cart/${e.id}`).then(()=>{this.getCart(),this.loadingItem="",localStorage.setItem("coupon",JSON.stringify(!1))})},deleteCarts(){this.$http.delete(`${b}v2/api/${f}/carts`).then(()=>{this.getCart(),localStorage.setItem("coupon",JSON.stringify(!1))})},showToast(e,o){this.$refs.showCouponUsedToast.showCouponUsedToast(e,o)},clear(){this.coupon=""},...w(C,["getCart","addToCart","useCoupon","showToast"])},computed:{...x(C,["carts","total","final_total","couponIsUsed"])},mounted(){this.getCart()}},j=$('<section class="container pt-6 pb-5"><h2 class="text-center pb-md-5 fw-bold">購物車清單</h2><div class="d-none d-md-block"><div class="row"><div class="col-3 pe-0"><div class="timeline-item d-flex flex-column align-items-center justify-content-center"><div class="line bg-black w-100"></div><div class="circle bg-primary border border-primary rounded-circle"></div><div class="mt-3 fw-bold">購物車清單</div></div></div><div class="col-3 px-0"><div class="timeline-item d-flex flex-column align-items-center justify-content-center"><div class="line bg-black w-100"></div><div class="circle bg-white border border-primary rounded-circle"></div><div class="mt-3">填寫訂購資料</div></div></div><div class="col-3 px-0"><div class="timeline-item d-flex flex-column align-items-center justify-content-center"><div class="line bg-black w-100"></div><div class="circle bg-white border border-primary rounded-circle"></div><div class="mt-3">填寫付款資料</div></div></div><div class="col-3 ps-0"><div class="timeline-item d-flex flex-column align-items-center justify-content-center"><div class="line bg-black w-100"></div><div class="circle bg-white border border-primary rounded-circle"></div><div class="mt-3">完成訂單</div></div></div></div></div></section>',1),S={class:"container py-3"},E={key:0,class:"table table-hover align-middle"},N=t("thead",null,[t("tr",{class:"table-primary"},[t("th",{class:"col-2"},"刪除"),t("th",{class:"col-6"},"品名"),t("th",{class:"col-3"},"數量"),t("th",{class:"col-2"},"單價")])],-1),L=["disabled","onClick"],R={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},D=t("i",{class:"bi bi-trash3 fs-6"},null,-1),q={class:"d-flex flex-column flex-md-row align-items-center justify-content-center"},A={class:"col-12 col-md-3 pb-2 pb-md-0 me-md-2"},B=["src"],O={class:"col-12 col-md-9 text-center text-md-start"},M={class:"input-group input-group-sm"},P={class:"input-group"},F=["onUpdate:modelValue","disabled","onChange"],H=["value"],J=t("td",{colspan:"3",class:"col-11 text-end"},"商品總金額",-1),W={key:0},z=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),G={class:"text-success"},K={class:"container bg-primary-exlight p-4"},Q={class:"d-flex justify-content-end align-items-center pb-4"},X=t("div",null," 輸入優惠碼 ",-1),Y={class:"px-3"},Z={key:0,class:"d-flex justify-content-end align-items-center pb-4 text-danger fw-bold"},tt={class:"d-flex flex-column flex-sm-row justify-content-between align-items-center"},et={key:1,class:"container pt-7"},st={class:"fs-2 text-center"};function ot(e,o,_,lt,a,c){const p=I("RouterLink");return l(),n("div",null,[j,e.carts.length?(l(),n(h,{key:0},[t("section",S,[e.carts.length?(l(),n("table",E,[N,t("tbody",null,[e.carts?(l(!0),n(h,{key:0},g(e.carts,s=>(l(),n("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:s.id===a.loadingItem,onClick:i=>c.deleteCart(s)},[s.id===a.loadingItem?(l(),n("span",R)):r("",!0),D],8,L)]),t("td",q,[t("div",A,[t("img",{src:s.product.imageUrl,class:"object-cover w-100",height:"120",alt:"產品圖片"},null,8,B)]),t("div",O,d(s.product.title),1)]),t("td",null,[t("div",M,[t("div",P,[y(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":i=>s.qty=i,disabled:s.id===a.loadingItem,onChange:i=>c.updateCart(s)},[(l(),n(h,null,g(10,i=>t("option",{value:i,key:`${i}165146`},d(i),9,H)),64))],40,F),[[T,s.qty]])])])]),t("td",null,d(s.product.price),1)]))),128)):r("",!0)]),t("tfoot",null,[t("tr",null,[J,t("td",null,"$"+d(e.$filters.currency(e.total)),1)]),e.couponIsUsed?(l(),n("tr",W,[z,t("td",G,"$"+d(e.$filters.currency(e.final_total)),1)])):r("",!0)])])):r("",!0)]),t("section",K,[t("div",Q,[X,t("div",Y,[y(t("input",{type:"text",class:"p-1",placeholder:"請輸入優惠碼","onUpdate:modelValue":o[0]||(o[0]=s=>a.coupon=s)},null,512),[[V,a.coupon]])]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:o[1]||(o[1]=s=>{e.useCoupon(this.coupon),c.clear()})}," 使用 ")]),e.couponIsUsed?(l(),n("div",Z," 優惠碼已使用，享"+d(e.final_total*10/e.total)+"折優惠 ",1)):r("",!0),t("div",tt,[t("div",null,[t("button",{onClick:o[2]||(o[2]=(...s)=>c.deleteCarts&&c.deleteCarts(...s)),type:"button",class:"btn btn-outline-danger mb-3 mb-sm-0"},"刪除所有品項")]),t("div",null,[m(p,{to:"/products",class:"btn btn-light me-4"},{default:v(()=>[u("繼續購物")]),_:1}),m(p,{to:e.carts.length?"/orderInformation":"",class:"btn btn-primary"},{default:v(()=>[u(" 結帳("+d(e.carts.length)+") ",1)]),_:1},8,["to"])])])])],64)):(l(),n("section",et,[t("div",st,[t("div",null,[u("購物車目前沒有商品，"),m(p,{to:"/products",class:"link-primary text-decoration-none"},{default:v(()=>[u("繼續購物")]),_:1})])])]))])}const dt=k(U,[["render",ot]]);export{dt as default};
